#' Combines objects by terms
#'
#' Combines two mcmc objects by terms.
#'
#' @param x an mcmc object.
#' @param x2 A second mcmc object.
#' @param ... Unused.
#' @export
bind_terms <- function(x, x2, ...) {
  UseMethod("bind_terms")
}

#' @export
bind_terms.mcmc <- function(x, x2, ...) {

  if (!identical(niters(x), niters(x2)))
    error("x and x2 must have the same number of iterations")

  x <- abind::abind(x, x2, along = 2)

  coda::as.mcmc(x)
}

#' @export
bind_terms.mcmc.list <- function(x, x2, ...) {

  if (!coda::is.mcmc.list(x)) error("x2 must be an mcmc.list")

  if (!identical(nchains(x), nchains(x2)))
    error("x and x2 must have the same number of chains")

  x <- purrr::map2(x, x2, bind_terms)
  class(x) <- "mcmc.list"
  x
}
